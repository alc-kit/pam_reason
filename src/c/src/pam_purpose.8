." Process this file with: groff -man -Tascii src/pam_purpose.8 | less.TH PAM_PURPOSE 8 "October 9, 2025" "Linux-PAM Manual" "System Administration".SH NAME.B pam_purpose- PAM module to require and audit a login purpose.SH SYNOPSIS.B auth.I control-flag.B pam_purpose.so.RI [ users=user1,user2,... ] [ groups=group1,group2,... ].SH DESCRIPTIONThe.B pam_purpose.somodule is designed to prompt interactive users for awritten purpose for their login session. The provided purpose isaudited via syslog for accountability..PPThe module determines if a session is interactive by inspecting the PAM_TTYitem. For non-interactive sessions, such as those initiated by automationtools (e.g., Ansible) or file transfer services (e.g., SCP/SFTP), themodule will automatically succeed and log the access as "AUTOMATED_ACCESS",ensuring that automated processes are not blocked..PPFor interactive sessions, the user is presented with a text prompt. An emptyor aborted response will cause the module to return an authenticationfailure..SH OPTIONS.TP.B users=.IR user1,user2,...This option restricts the module's execution to a comma-separatedlist of usernames..TP.B groups=.IR group1,group2,...This option restricts the module's execution to users who are membersof one or more of the specified comma-separated groups..PPIf both options are provided, the module will apply to any user who matcheseither the user list or the group list. If no options are provided, themodule will not apply to any user and will always return success..SH "SECURITY CONSIDERATIONS"The.B pam_purpose.somodule can introduce a severe security vulnerabilityif misconfigured. Administrators must adhere to the following rules:.IP 1. 3The control-flag for this module.B MUSTbe set to.B requiredor.BR requisite .Using.B sufficientwill create a serious securityvulnerability, allowing any matched user to bypass primaryauthentication mechanisms..IP 2. 3This module.B MUSTbe placed in the.B authstack.I aftertheprimary authentication module(s) (e.g.,.BR pam_unix.so )..SH EXAMPLESThe following is an example configuration for.BR /etc/pam.d/sshd ..nfRequire a login purpose from user 'alice' and any memberof the 'wheel' group AFTER they have been authenticated.auth    required    /lib/x86_64-linux-gnu/security/pam_purpose.so users=alice groups=wheel.fi.SH "SEE ALSO".BR pam.conf (5),.BR pam (8),.BR syslog (3)
